#!/usr/bin/env bash
# Initialize from current state
current=$(xprop -root _NET_ACTIVE_WINDOW | grep -o '0x[0-9a-f]*')
previous=$(cat ~/.last_window 2>/dev/null || echo "")

xprop -spy -root _NET_ACTIVE_WINDOW | while read line; do
    new_id=$(echo "$line" | grep -o '0x[0-9a-f]*')
    if [ "$new_id" != "$current" ]; then
        previous="$current"
        current="$new_id"
        echo "$previous" > ~/.last_window
    fi
done
